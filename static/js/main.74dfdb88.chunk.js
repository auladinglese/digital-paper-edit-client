(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{151:function(e,t,r){e.exports={speaker:"Paragraphs_speaker__2hb7q",unselectable:"Paragraphs_unselectable__-gkJp",highlightedWord:"Paragraphs_highlightedWord__2R7lz"}},231:function(e,t,r){"use strict";(function(e,r){function a(){if(void 0===window.process||void 0!==window.process.versions.node)return"demo";if(void 0!==window.process.versions.electron)return"electron";if(void 0!==window.process.versions.cep){try{e.chdir(r)}catch(t){console.log("chdir: "+t)}return"cep"}console.error("couldn't determine the js environment")}t.a=a}).call(this,r(117),"/")},238:function(e,t,r){e.exports=r(457)},243:function(e,t,r){},457:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(15),o=r.n(s),c=(r(243),r(244),Object(a.createContext)()),i=r(71),l=r.n(i),u=r(33),p=r(232),d=r(14),h=r(21),m=r(20),f=r(22),b=r(2),g=r.n(b),v=r(7),w=r(29),E=r(13),y=r(8),j=r(56),S=r.n(j),k=r(233),x=r(10),O=r(9);var P=function(){var e=n.a.createElement(k.a,{collapseOnSelect:!0,expand:"md",bg:"light",variant:"light",fixed:"bottom",className:"justify-content-center"},n.a.createElement(x.a,{icon:O.i})," ",n.a.createElement("small",null,"This is a prototype by "," ",n.a.createElement("a",{href:"http://bbcnewslabs.co.uk",target:"_blank",rel:"noopener noreferrer"},"BBC News Labs")));return n.a.createElement(E.a,null,n.a.createElement(y.a,{className:"d-none d-sm-block"},e),n.a.createElement(y.a,{className:"d-lg-block d-md-block"},e))},T=r(40),C=r(23),I=function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},L=r(211),A=r.n(L),D=r(212),N=r.n(D),U=r(213),F=r.n(U);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var R={title:"",description:"",id:null},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,r=t.type,a=t.payload;switch(r){case"update":return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(r,!0).forEach(function(t){Object(T.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{},a);case"reset":return{initialFormState:R};default:return e}},W=function(e){var t,r,s=e.type,o=Object(a.useState)([]),c=Object(w.a)(o,2),i=c[0],l=c[1],u=Object(a.useState)(!1),p=Object(w.a)(u,2),d=p[0],h=p[1],m=Object(a.useReducer)(J,R),f=Object(w.a)(m,2),b=f[0],g=f[1];return Object(a.useEffect)(function(){return I(e.items,i)||l(e.items),function(){}},[i,e.items]),i.length>0?(t=n.a.createElement(N.a,{handleSearch:function(e){var t=i.map(function(t){return function(e,t){var r,a;return r=[e.title,e.description],a=t,r.find(function(e){return function(e,t){return e.toLowerCase().trim().includes(t.toLowerCase().trim())}(e,a)})?e.display=!0:e.display=!1,e}(t,e)});l(t)}}),r=n.a.createElement(A.a,{items:i,handleEditItem:function(e){var t=i.find(function(t){return t.id===e});g({type:"update",payload:t}),h(!0)},handleDeleteItem:function(t){e.handleDelete(t)}})):r=n.a.createElement("i",null,"There are no ",s,"s, create a new one to get started."),n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:9},t),n.a.createElement(y.a,{xs:12,sm:3},n.a.createElement(C.a,{onClick:function(){console.log("toggle",!d),h(!d)},variant:"outline-secondary",size:"sm",block:!0},"New ",s))),r,n.a.createElement(F.a,Object.assign({},b,{modalTitle:b.id?"Edit ".concat(s):"New ".concat(s),showModal:d,handleSaveForm:function(t){e.handleSave(t),h(!1),g({type:"reset"})},itemType:s.toLowerCase})))};W.defaultProps={type:"Project"};var _=W,B=r(74);var q=function(e,t,r){var a=r,n=r.findIndex(function(t){return t.id===e});return Object.assign(a[n],t),a},H=function(e,t){return t.filter(function(t){return t.id!==e})},z=function(e,t){return[].concat(Object(B.a)(t),[e])},V=function(){var e=Object(a.useState)(!1),t=Object(w.a)(e,2),r=t[0],s=t[1],o=Object(a.useState)([]),i=Object(w.a)(o,2),l=i[0],p=i[1],d="Project",h=Object(a.useContext)(c),m=function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.createProject(t);case 2:(r=e.sent).ok?((a=r.project).display=!0,n=z(a,l),p(n)):console.error("Failed to add project",t);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.updateProject(t,r);case 2:(a=e.sent).ok&&((n=a.project).display=!0,s=q(t,n,l),p(s));case 4:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(v.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.id){e.next=6;break}return e.next=3,f(t.id,t);case 3:return e.abrupt("return",e.sent);case 6:return e.next=8,m(t);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(v.a)(g.a.mark(function e(t){var r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.deleteProject(t);case 3:r=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:return console.log("api.deleteProject",r),e.abrupt("return",r);case 11:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){return r||(function(){var e=Object(v.a)(g.a.mark(function e(){var t,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,h.getAllProjects();case 4:r=e.sent,t=r.map(function(e){var t=e.id;return e.key=t,e.url="/projects/".concat(t),e.display=!0,e}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Failed to get projects");case 11:p(t);case 12:case"end":return e.stop()}},e,null,[[1,8]])}));return function(){return e.apply(this,arguments)}}()(),s(!0)),function(){}},[h,r,l]);var k=[{name:"".concat(d,"s"),link:"/".concat(d,"s")}];return n.a.createElement(n.a.Fragment,null,n.a.createElement(u.a,{"data-testid":"projectsContainer",style:{marginBottom:"5em",marginTop:"1em"}},n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:12},n.a.createElement(S.a,{"data-testid":"projectsBreadcrumb",items:k}))),n.a.createElement(_,{key:d,model:d,items:l,handleSave:b,handleDelete:function(e){if(console.log("handle delete"),j(e).ok){var t=H(e,l);p(t)}}})),n.a.createElement(P,null))},K=r(236),G=r(64),X=n.a.memo(function(e){var t=Object(a.useContext)(c),r=Object(a.useState)(!1),s=Object(w.a)(r,2),o=s[0],i=s[1],l=Object(a.useState)([]),u=Object(w.a)(l,2),p=u[0],d=u[1],h=Object(a.useState)(!1),m=Object(w.a)(h,2),f=m[0],b=m[1],E=Object(a.useState)(),y=Object(w.a)(E,2),j=y[0],S=y[1];Object(a.useEffect)(function(){var r,a=function(){var r=Object(v.a)(g.a.mark(function r(){var a,n;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getTranscripts(e.projectId);case 2:(a=r.sent)&&(n=a.transcripts.map(function(t){var r;return t.display=!0,t.url=(r=t.id,"/projects/".concat(e.projectId,"/transcripts/").concat(r,"/correct")),t.projectId=e.projectId,t}),d(n));case 4:case"end":return r.stop()}},r)}));return function(){return r.apply(this,arguments)}}();return o||(i(!0),a()),f&&!j&&S(setTimeout(function(){a()},3e4)),p.length>0&&b(0!==(r=p).length&&!!r.find(function(e){return"in-progress"===e.status})),function(){clearInterval(j)}},[t,j,o,f,p,e.projectId]);var k=function(){var r=Object(v.a)(g.a.mark(function r(a,n){var s,o,c,i,l;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,t.updateTranscript(e.projectId,a,!1,n);case 3:(s=r.sent).ok?(o=s.transcript,c=p.findIndex(function(e){return e.id===a}),i=p[c],o.display=!0,o.status=i.status,l=q(a,o,p),d(l)):console.log("api.updateTranscript",s);case 5:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}(),x=function(){var e=Object(v.a)(g.a.mark(function e(r){var a,n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createTranscript(r);case 2:(a=e.sent).ok?((n=a.transcript).display=!0,n.status="in-progress",s=z(n,p),d(s)):console.log("api.updateTranscript",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),O=function(e){return e.id?k(e.id,e):x(e)},P=function(){var r=Object(v.a)(g.a.mark(function r(a){var n;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return console.log(t),r.prev=1,r.next=4,t.deleteTranscript(e.projectId,a);case 4:n=r.sent,r.next=10;break;case 7:r.prev=7,r.t0=r.catch(1),console.log(r.t0);case 10:return console.log("api.deleteTranscript",n),r.abrupt("return",n);case 12:case"end":return r.stop()}},r,null,[[1,7]])}));return function(e){return r.apply(this,arguments)}}(),T=function(e){if(P(e).ok){var t=H(e,p);d(t)}};return n.a.createElement(c.Consumer,null,function(){return n.a.createElement(_,{type:"Transcript",key:"Transcript",items:p,handleSave:O,handleDelete:T})})}),Y=function(e){var t=Object(a.useContext)(c),r=Object(a.useState)([]),s=Object(w.a)(r,2),o=s[0],i=s[1],l=Object(a.useState)(!1),u=Object(w.a)(l,2),p=u[0],d=u[1];Object(a.useEffect)(function(){return p||(function(){var r=Object(v.a)(g.a.mark(function r(){var a,n;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getAllPaperEdits(e.projectId);case 2:a=r.sent,n=a.map(function(t){var r;return t.display=!0,t.url=(r=t.id,"/projects/".concat(e.projectId,"/paperedits/").concat(r)),t.projectId=e.projectId,t}),i(n);case 5:case"end":return r.stop()}},r)}));return function(){return r.apply(this,arguments)}}()(),d(!0)),function(){}},[t,p,o,e.projectId]);var h=function(){var r=Object(v.a)(g.a.mark(function r(a){var n,s,c;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.createPaperEdit(e.projectId,a);case 2:(n=r.sent).ok?((s=n.paperedit).display=!0,c=z(s,o),i(c)):console.log("api.createPaperEdit",n);case 4:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}(),m=function(){var r=Object(v.a)(g.a.mark(function r(a,n){var s,c,l;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.updatePaperEdit(e.projectId,a,n);case 2:s=r.sent,c=s.paperedit,s.ok&&c?(c.display=!0,l=q(a,c,o),i(l)):console.log("api.createPaperEdit",s);case 5:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}(),f=function(e){return e.id?m(e.id,e):h(e)},b=function(){var r=Object(v.a)(g.a.mark(function r(a){var n;return g.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.deletePaperEdit(e.projectId,a);case 3:n=r.sent,r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),console.log(r.t0);case 9:return console.log("api.deletePaperEdit",n),r.abrupt("return",n);case 11:case"end":return r.stop()}},r,null,[[0,6]])}));return function(e){return r.apply(this,arguments)}}(),E=function(e){if(console.log("handle delete"),b(e).ok){var t=H(e,o);i(t)}};return n.a.createElement(c.Consumer,null,function(){return n.a.createElement(_,{type:"Paper Edit",items:o,handleSave:f,handleDelete:E})})},$=function(e){return[{name:"Projects",link:"/projects"},{name:e}]},Q=function(e){var t=Object(a.useContext)(c),r=e.match.params.projectId,s=Object(a.useState)("transcripts"),o=Object(w.a)(s,2),i=o[0],l=o[1],p=Object(a.useState)("Project Name"),d=Object(w.a)(p,2),h=d[0],m=d[1];return Object(a.useEffect)(function(){return function(){var e=Object(v.a)(g.a.mark(function e(){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getProject(r);case 3:a=e.sent,m(a.project.title),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Could not get Project Id: ",r,e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}()(),function(){}},[t,r,h]),n.a.createElement(c.Consumer,null,function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(u.a,{style:{marginBottom:"5em",marginTop:"1em"}},n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:12},n.a.createElement(S.a,{items:$(h)}))),n.a.createElement(K.a,{id:"controlled-tab-example",activeKey:i,onSelect:function(e){return l(e)}},n.a.createElement(G.a,{eventKey:"transcripts",title:"Transcripts"},n.a.createElement(u.a,{style:{marginBottom:"5em",marginTop:"1em"}},n.a.createElement(X,{projectId:r}))),n.a.createElement(G.a,{eventKey:"paperedits",title:"Paper Edits"},n.a.createElement(u.a,{style:{marginBottom:"5em",marginTop:"1em"}},n.a.createElement(Y,{projectId:r}))))),n.a.createElement(P,null))})},Z=r(17),ee=r(214),te=r(58),re=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=function(){r.context.getTranscript(r.state.projectId,r.state.transcriptId).then(function(e){r.setState({projectTitle:e.projectTitle,transcriptTitle:e.transcriptTitle,transcriptJson:e.transcript,url:e.url,mediaType:e.mediaType})})},r.saveToServer=function(){var e=r.context;alert("save to server");var t=r.transcriptEditorRef.current.getEditorContent("digitalpaperedit").data;t.title=r.state.transcriptTitle,t.transcriptTitle=r.state.transcriptTitle;e.updateTranscript(r.state.projectId,r.state.transcriptId,!1,t).then(function(e){console.log("api.updateTranscript",e),e.ok&&(console.log("updated"),r.setState({savedNotification:n.a.createElement(l.a,{dismissable:!0,variant:"success",heading:"Transcript saved",message:n.a.createElement("p",null,"Transcript: ",n.a.createElement("b",null,r.state.transcriptTitle)," has been saved")})}))}).catch(function(e){console.error("error saving transcript:: ",e),r.setState({savedNotification:n.a.createElement(l.a,{dismissable:!0,variant:"danger",heading:"Error saving transcript",message:n.a.createElement("p",null,"There was an error trying to save this transcript: ",n.a.createElement("b",null,r.state.transcriptTitle))})})})},r.redirectToAnnotatePage=function(){r.setState({redirect:!0})},r.renderRedirect=function(){if(r.state.redirect)return n.a.createElement(te.c,{to:"/projects/".concat(r.state.projectId,"/transcripts/").concat(r.state.newTranscriptId,"/annotate")})},r.state={projectId:r.props.match.params.projectId,transcriptId:r.props.match.params.transcriptId,transcriptJson:null,url:null,projectTitle:"",transcriptTitle:"",savedNotification:null,mediaType:"video"},r.transcriptEditorRef=n.a.createRef(),r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,this.renderRedirect(),n.a.createElement(u.a,{style:{marginBottom:"5em"},fluid:!0},n.a.createElement("br",null),n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:12,md:11,ld:11,xl:11},n.a.createElement(S.a,{items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"Transcripts"},{name:"".concat(this.state.transcriptTitle)},{name:"Correct"}]})),n.a.createElement(y.a,{xs:12,sm:1,md:1,ld:1,xl:1},n.a.createElement(C.a,{variant:"outline-secondary",onClick:this.saveToServer,size:"lg",block:!0},"Save"),n.a.createElement("br",null))),this.state.savedNotification,null!==this.state.transcriptJson&&n.a.createElement(ee.TranscriptEditor,{transcriptData:this.state.transcriptJson,mediaUrl:this.state.url,isEditable:!0,sttJsonType:"digitalpaperedit",title:this.state.transcriptTitle,ref:this.transcriptEditorRef,mediaType:this.state.mediaType})))}}]),t}(a.Component);re.contextType=c;var ae=re,ne=r(73),se=r(72),oe=r(31),ce=r(12),ie=r(109),le=r(28),ue=r(53),pe=r(107),de=r(152);function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(r,!0).forEach(function(t){Object(T.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var fe={control:function(e){return me({},e,{backgroundColor:"white"})},option:function(e,t){var r=t.data,a=t.isDisabled;t.isFocused,t.isSelected;return me({},e,{backgroundColor:null,borderLeft:"1.5em solid",borderColor:r.color,marginBottom:"0.4em",cursor:a?"not-allowed":"default"})},multiValue:function(e,t){return me({},e,{backgroundColor:"white",border:"0.05em solid",borderLeft:"1.2em solid",borderColor:t.data.color})},multiValueLabel:function(e,t){t.data;return me({},e)},multiValueRemove:function(e,t){t.data;return me({},e)}};function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(r,!0).forEach(function(t){Object(T.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ve={control:function(e){return ge({},e,{backgroundColor:"white"})},option:function(e){return ge({},e,{backgroundColor:null,cursor:"default"})},multiValue:function(e){return ge({},e,{backgroundColor:"white",border:"0.05em solid grey"})},multiValueLabel:function(e){return ge({},e)},multiValueRemove:function(e){return ge({},e)}},we=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).handleToggleSearchTextPreferences=function(){r.setState(function(e){return{showTextSearchPreferences:!e.showTextSearchPreferences}})},r.handleToggleSearchLabelsPreferences=function(){r.setState(function(e){return{showLabelsSearchPreferences:!e.showLabelsSearchPreferences}})},r.handleToggleSearchSpeakersPreferences=function(){r.setState(function(e){return{showSpeakersSearchPreferences:!e.showSpeakersSearchPreferences}})},r.handleSpeakersSearchChange=function(e){r.props.handleSpeakersSearchChange(e),r.setState({selectedOptionSpeakerSearch:e})},r.handleLabelsSearchChange=function(e){r.props.handleLabelsSearchChange(e),r.setState({selectedOptionLabelSearch:e})},r.handleShowParagraphsMatchingSearch=function(){r.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}},function(){r.props.handleShowParagraphsMatchingSearch()})},r.handleToggleAll=function(){r.setState(function(e){return{showTextSearchPreferences:!0,showSpeakersSearchPreferences:!0,showLabelsSearchPreferences:!0,showParagraphsMatchingSearch:!0}},function(){r.props.handleShowParagraphsMatchingSearch()})},r.handleHideAll=function(){r.setState(function(e){return{showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1,showParagraphsMatchingSearch:!1}},function(){r.props.handleShowParagraphsMatchingSearch()})},r.state={showParagraphsMatchingSearch:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(oe.a.Header,null,n.a.createElement(ue.a,{className:"mb-3"},n.a.createElement(ue.a.Prepend,null,n.a.createElement(ue.a.Text,null,n.a.createElement(x.a,{icon:O.q}))),n.a.createElement(pe.a,{onChange:function(t){e.props.handleSearch(t,{showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,showLabelsSearchPreferences:e.state.showLabelsSearchPreferences,showSpeakersSearchPreferences:e.state.showSpeakersSearchPreferences})},placeholder:"Search text...","aria-label":"search","aria-describedby":"search"}),n.a.createElement(ie.a,{drop:"right",as:ue.a.Append,variant:"outline-secondary",title:n.a.createElement(n.a.Fragment,null,n.a.createElement(x.a,{icon:O.h,title:"Filter results"}))},n.a.createElement(ce.a.Item,{onClick:this.handleToggleSearchLabelsPreferences,title:"Filter results by Labels"},n.a.createElement(x.a,{icon:O.v}),"  Labels ",this.state.showLabelsSearchPreferences?n.a.createElement(x.a,{style:{color:"blue"},icon:O.d}):""),n.a.createElement(ce.a.Item,{onClick:this.handleToggleSearchSpeakersPreferences,title:"Filter results by Speakers"},n.a.createElement(x.a,{icon:O.z})," Speakers  ",this.state.showSpeakersSearchPreferences?n.a.createElement(x.a,{style:{color:"blue"},icon:O.d}):""),n.a.createElement(ce.a.Item,{onClick:this.handleToggleSearchTextPreferences,title:"Show only matching paragraphs"},n.a.createElement(x.a,{icon:O.a})," Paragraphs only ",this.state.showTextSearchPreferences?n.a.createElement(x.a,{style:{color:"blue"},icon:O.d}):""),n.a.createElement(ce.a.Item,{onClick:this.handleToggleAll,title:"Show all of the above options"},"All ",this.state.showLabelsSearchPreferences&&this.state.showSpeakersSearchPreferences&&this.state.showTextSearchPreferences?n.a.createElement(x.a,{style:{color:"blue"},icon:O.d}):""),n.a.createElement(ce.a.Divider,null),n.a.createElement(ce.a.Item,{onClick:this.handleHideAll,title:"Deselect all the options"},"Deselect all"))),this.state.showLabelsSearchPreferences?n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,{className:"mb-3"},n.a.createElement(y.a,{xs:1,sm:1,md:1,ld:1,xl:1},n.a.createElement(ue.a.Prepend,null,n.a.createElement(ue.a.Text,null,n.a.createElement(x.a,{icon:O.v})))),n.a.createElement(y.a,{xs:10,sm:11,md:11,ld:11,xl:11},n.a.createElement(de.a,{value:this.state.selectedOptionLabelSearch,onChange:this.handleLabelsSearchChange,isMulti:!0,isSearchable:!0,options:this.props.labelsOptions,styles:fe,placeholder:"Filter by label..."})))):"",this.state.showSpeakersSearchPreferences?n.a.createElement(n.a.Fragment,null,n.a.createElement(E.a,{className:"mb-3"},n.a.createElement(y.a,{xs:1,sm:1,md:1,ld:1,xl:1},n.a.createElement(ue.a.Prepend,null,n.a.createElement(ue.a.Text,null,n.a.createElement(x.a,{icon:O.z})))),n.a.createElement(y.a,{xs:10,sm:11,md:11,ld:11,xl:11},n.a.createElement(de.a,{value:this.state.selectedOptionSpeakerSearch,onChange:this.handleSpeakersSearchChange,isMulti:!0,isSearchable:!0,options:this.props.speakersOptions,styles:ve,placeholder:"Filter by speaker..."})))):"",this.state.showTextSearchPreferences?n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a.Check,{type:"checkbox",checked:this.state.showParagraphsMatchingSearch,onChange:this.handleShowParagraphsMatchingSearch,label:n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a.Text,{className:"text-muted",title:"Show only matching paragraphs",onClick:this.handleShowParagraphsMatchingSearch},"Show only matching paragraphs"))})):""))}}]),t}(a.Component);var Ee=function(e,t){return function(e,t){var r=[],a=0,n=0,s={words:[],text:"",speaker:""};return e.forEach(function(e){var o=function(e,t){return t.find(function(t){if(e.start>=t.start&&e.end<=t.end)return t})}(e,t);void 0!==o&&((a=t.indexOf(o))===n?(s.words.push(e),s.text+=e.text+" ",s.speaker=o.speaker):(n=a,s.text.trim(),r.push(s),(s={words:[],text:"",speaker:""}).words.push(e),s.text+=e.text+" ",s.speaker=o.speaker))}),r.push(s),r}(e,t)},ye=function(e,t){var r=t[0].start,a=t[t.length-1].end,n=function(e,t,r){return e.find(function(e){return e.start>=t&&e.end<=r})}(e,r,a);if(n)return n;var s=function(e,t,r){return e.find(function(e){return e.start>=t&&e.start<=r})}(e,r,a);if(s)return s;var o=function(e,t,r){return e.find(function(e){return e.end>=t&&e.end<=r})}(e,r,a);if(o)return o;var c=function(e,t,r){return e.find(function(e){return e.start<=t&&e.end>=r})}(e,r,a);return c||!1},je=r(221),Se=r(151),ke=r.n(Se);function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(r,!0).forEach(function(t){Object(T.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var Pe=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e=this.props.paragraphDisplayPreference;e.borderStyle="dashed",e.borderWidth="0.01em",e.borderColor="lightgray",e.padding="0.5em";var t={};return this.props.showParagraphsMatchingSearch?t=this.props.paragraphDisplayPreference:e.display||(delete e.display,t.borderRight="0.1em dashed lightgrey",t.borderLeft="0.1em dashed lightgrey"),n.a.createElement(E.a,{style:Oe({},t),className:"paragraph","data-paragraph-text":this.props.paragraphTextWithoutPunctuation},n.a.createElement(y.a,{xs:12,sm:12,md:3,lg:3,xl:2,style:{cursor:"pointer",width:"100%"},className:"text-truncate",title:"".concat(this.props.speakerName.toUpperCase()," -  ").concat(Object(je.shortTimecode)(this.props.paragraph[0].start))},n.a.createElement("span",{className:[ke.a.speaker,ke.a.unselectable,"timecode"].join(" "),"data-start":this.props.paragraph[0].start,tabIndex:"0"},this.props.speakerName)),n.a.createElement(y.a,{xs:12,sm:12,md:9,lg:9,xl:10},this.props.wordsElements))}}]),t}(a.Component),Te=function(e){return e.replace(/\.|\?|!|,|;/,"").toLowerCase()},Ce=function(e){function t(){var e,r;Object(d.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(r=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).generatePreviousTimes=function(e){for(var t="",r=0;r<e;r++)t+="".concat(r," ");if(e%1>0){var a=Math.floor(e%1*4)/4;t+=" ".concat(Math.floor(e)+a)}return t},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transcriptId,r=e.speaker,a=e.word;return n.a.createElement("span",{title:"start:".concat(a.start," - end:").concat(a.end),"data-prev-times":this.generatePreviousTimes(a.start),className:["words"].join(" "),"data-start":a.start,"data-text":Te(a.text),"data-end":a.end,"data-transcript-id":t,"data-speaker":r,key:"key_"+a.id+"_"+a.end,role:"button","aria-pressed":"false",onKeyDown:this.props.handleKeyDownWords},a.text," ")}}]),t}(a.Component),Ie=r(235),Le=r(237),Ae=function(e){function t(){var e,r;Object(d.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(r=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).handleEditAnnotation=function(){r.props.handleEditAnnotation(r.props.annotationId,void 0)},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e,t=this;if(this.props.labelsOptions){var r=this.props.labelsOptions.find(function(e){return e.id===t.props.annotationLabelId});r||(r=this.props.labelsOptions[0]),e=n.a.createElement(Le.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:n.a.createElement(Ie.a,{id:"popover-basic"},n.a.createElement(E.a,null,n.a.createElement(y.a,{md:1,style:{backgroundColor:r.color,marginLeft:"1em"}}),n.a.createElement(y.a,null,n.a.createElement(x.a,{icon:O.v}),"  ",r.label),n.a.createElement(y.a,{md:1,style:{marginRight:"1em"},onClick:function(){t.props.handleDeleteAnnotation(t.props.annotationId)}},n.a.createElement(x.a,{icon:O.y}))),n.a.createElement("hr",null),n.a.createElement(x.a,{icon:O.s,onClick:this.handleEditAnnotation}),"   ",this.props.annotationNote,n.a.createElement("br",null),n.a.createElement(x.a,{icon:O.n,onClick:this.handleEditAnnotation}))},n.a.createElement("span",{style:{borderBottom:"0.1em ".concat(r.color," solid")},className:"highlight"},this.props.words))}return n.a.createElement(n.a.Fragment,null,e)}}]),t}(a.Component);var De=function(e,t,r){var a={};return e||(a={display:"none"}),t||(a={display:"none"}),r||(a={display:"none"}),a},Ne=function(e,t){return e.map(function(e){return e.words=function(e,t){return e.map(function(e){var r=function(e,t,r){return e.find(function(e){return t>=e.start&&r<=e.end})}(t,e.start,e.end);return r?e.annotation=r:delete e.annotation,e})}(e.words,t),e})},Ue=function(e){function t(){var e,r;Object(d.a)(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return(r=Object(h.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(n)))).handleKeyDownTimecodes=function(e){"Enter"===e.key&&r.props.handleTimecodeClick(e)},r.handleKeyDownWords=function(e){"Enter"===e.key&&r.props.handleWordClick(e)},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e,t=this,r={},a=Ee(this.props.transcriptJson.words,this.props.transcriptJson.paragraphs),s=Ne(a,this.props.annotations).map(function(a,s){var o=ye(t.props.annotations,a.words),c=a.text.replace(/\.|\?|!|,|;/,"").toLowerCase(),i=c.includes(t.props.searchString.toLowerCase()),l=!1;0!==t.props.selectedOptionSpeakerSearch.length?t.props.selectedOptionSpeakerSearch.find(function(e){return e.label===a.speaker})&&(l=!0):l=!0;var u=!1;return 0!==t.props.selectedOptionLabelSearch.length?t.props.selectedOptionLabelSearch.find(function(e){return e.id===o.labelId})&&(u=!0):u=!0,r=De(i,l,u),e=a.words.map(function(e,r){var s=n.a.createElement(Ce,{transcriptId:t.props.transcriptId,speaker:a.speaker,key:"key--"+r,word:e,handleKeyDownWords:function(e){return"Enter"===e.key?t.props.handleWordClick(e):null}});return e.annotation?n.a.createElement(Ae,{key:"key----"+r,words:s,labelsOptions:t.props.labelsOptions,annotationLabelId:e.annotation.labelId,annotationId:e.annotation.id,annotationNote:e.annotation.note,handleDeleteAnnotation:t.props.handleDeleteAnnotation,handleEditAnnotation:t.props.handleEditAnnotation}):s}),n.a.createElement(Pe,{showParagraphsMatchingSearch:t.props.showParagraphsMatchingSearch,paragraphDisplayPreference:r,key:"key------"+s,paragraphTextWithoutPunctuation:c,speakerName:a.speaker,paragraph:a.words,handleKeyDownTimecodes:function(e){return"Enter"===e.key?t.props.handleTimecodeClick(e):null},wordsElements:e})});return n.a.createElement(n.a.Fragment,null,s)}}]),t}(a.Component),Fe=r(153),Me=r(83),Re=r(223),Je={yellow:"#ffff00",greenyellow:"#adff2f",deepskyblue:"#00bfff",deeppink:"#ff1493",aqua:"#00ffff",black:"#000000",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",blue:"#0000ff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",chartreuse:"#7fff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",yellowgreen:"#9acd32",aquamarine:"#7fffd4",mediumaquamarine:"#66cdaa"},We=Object.freeze(Object.keys(Je).splice(0,15)),_e=[];for(var Be in Je)_e.push({value:Be,label:Be,color:Je[Be]});var qe=-1,He=We.length,ze=function(){return qe<He?qe+=1:qe=0,We[qe]},Ve=r(82),Ke=r.n(Ve),Ge=function(e){function t(e,r){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e,r))).handleRandomiseColor=function(){a.setState({color:ze()})},a.handleColorPickerChangeComplete=function(e){a.setState({color:Ke()(e.hex).name()})},a.handleManualColorChange=function(e){if(e&&e.target&&e.target.value){var t=e.target.value;a.setState({color:Ke.a.valid(t)?Ke()(t).name():t})}else e&&e.target&&""===e.target.value&&a.setState({color:""})},a.handleColorSelectChange=function(e){a.setState({color:e.color})},a.handleSave=function(){Ke.a.valid(a.state.color)?""!==a.state.label?(a.props.onLabelSaved({value:a.state.color,label:a.state.label,color:a.state.color,description:a.state.description,id:a.state.labelId}),a.props.handleClose()):alert("add a name to the label to be able to save"):alert("choose a valid color")},a.state={color:a.props.color,label:a.props.label,description:a.props.description,labelId:a.props.labelId},a}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement(le.a,null,n.a.createElement(le.a.Group,{controlId:"formGroupEmail"},n.a.createElement(le.a.Label,null,"Label Name "),n.a.createElement(le.a.Control,{type:"text",placeholder:"Enter label name",defaultValue:this.state.label,onInput:function(t){e.setState({label:t.target.value})}}),n.a.createElement(le.a.Text,{className:"text-muted"},"Required label name")),n.a.createElement(le.a.Group,{controlId:"formGroupPassword"},n.a.createElement(le.a.Label,null,"Label Description"),n.a.createElement(le.a.Control,{type:"text",placeholder:"Enter label description",defaultValue:this.state.description,as:"textarea",rows:"3",onInput:function(t){e.setState({description:t.target.value})}}),n.a.createElement(le.a.Text,{className:"text-muted"},"Optional label description")),n.a.createElement(le.a.Group,{controlId:"formGroupPassword"},n.a.createElement(le.a.Label,null,"Color"),n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:2,sm:1,md:1,lg:1,xl:1},n.a.createElement(C.a,{onClick:this.handleRandomiseColor,variant:"light",size:"sm"},n.a.createElement(x.a,{icon:O.u}))),n.a.createElement(y.a,{xs:6,sm:6,md:6,lg:6,xl:6},n.a.createElement(le.a.Control,{value:this.state.color,type:"text",placeholder:"#",onChange:this.handleManualColorChange})),n.a.createElement(y.a,{xs:2,sm:2,md:2,lg:2,xl:2,style:{backgroundColor:this.state.color,border:"solid",borderWidth:"0.01em",borderColor:"grey",padding:"0"}})),n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:12,sm:12,md:12,lg:12,xl:12},n.a.createElement(le.a.Text,{className:"text-muted"},"To pick a color you can chose one at random, pick one form the list below, or type the name or hex code above."),n.a.createElement(Re.GithubPicker,{width:"100%",color:this.state.color,triangle:"hide",onChangeComplete:this.handleColorPickerChangeComplete,colors:We})))),n.a.createElement(C.a,{variant:"primary",onClick:this.handleSave},"Save")))}}]),t}(a.Component),Xe=function(e){function t(e,r){var a;return Object(d.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e,r))).handleClose=function(){a.setState({show:!1})},a.handleShow=function(){a.setState({show:!0})},a.state={show:!1,color:a.props.color,label:a.props.label,description:a.props.description,labelId:a.props.labelId},a}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(C.a,{variant:"link",size:"sm",onClick:this.handleShow,block:!0},this.props.openBtn),n.a.createElement(Me.a,{show:this.state.show,onHide:this.handleClose},n.a.createElement(Me.a.Header,{closeButton:!0},n.a.createElement(Me.a.Title,null,n.a.createElement(x.a,{icon:O.v}),"  Label ")),n.a.createElement(Me.a.Body,null,n.a.createElement(Ge,{onLabelSaved:this.props.onLabelSaved,label:this.props.label,description:this.props.description,color:this.props.color,labelId:this.props.labelId,handleClose:this.handleClose}))))}}]),t}(a.Component),Ye=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).removeLabel=function(e,t){!0===confirm("Click OK to delete the label, Cancel if you changed your mind")?r.props.onLabelDelete(e):alert("Your label was not deleted")},r.editLabel=function(e,t){var a=r.props.labelsOptions.filter(function(t){return t.id===e});console.log("labelToEdit",a)},r.onLabelSaved=function(e){e.id?r.props.onLabelUpdate(e):r.props.onLabelCreate(e)},r.showLabelModal=function(){console.log(r.state.isLabelmodalShown),r.setState(function(e){return{isLabelmodalShown:!e.isLabelmodalShown}})},r.state={isLabelmodalShown:!1},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e,t=this;this.props.labelsOptions&&(e=this.props.labelsOptions.map(function(e,r){return n.a.createElement(Fe.a.Item,{style:{width:"100%"},key:"label_"+r},n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},title:e.label}),n.a.createElement(y.a,{xs:6,sm:6,md:6,lg:6,xl:6,title:e.label},e.label),n.a.createElement(y.a,{xs:1,sm:1,md:1,lg:1,xl:1},"default"!==e.label.toLowerCase()?n.a.createElement(Xe,{color:e.color,label:e.label,description:e.description,labelId:e.id,show:t.state.isLabelmodalShown,onLabelSaved:t.onLabelSaved,openBtn:n.a.createElement("span",null," ",n.a.createElement(x.a,{icon:O.n}))}):n.a.createElement(C.a,{title:"edit label",variant:"link",size:"sm",disabled:!0},n.a.createElement(x.a,{icon:O.n})," ")),n.a.createElement(y.a,{xs:1,sm:1,md:1,lg:1,xl:1},n.a.createElement(C.a,{title:"delete label",variant:"link",size:"sm",onClick:function(r){t.removeLabel(e.id,r)},disabled:"default"===e.label.toLowerCase()},n.a.createElement(x.a,{icon:O.x})))),n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:1,sm:1,md:1,lg:1,xl:1,className:"text-truncate",title:e.label}),n.a.createElement(y.a,{xs:10,sm:10,md:10,lg:10,xl:10},n.a.createElement(le.a.Text,{title:e.description},e.description))))}));var r=n.a.createElement(Fe.a,{style:{height:"50vh",width:"20vw",overflowY:"scroll",overflowX:"hidden"}},e);return n.a.createElement(n.a.Fragment,null,this.props.isLabelsListOpen?n.a.createElement(n.a.Fragment,null,n.a.createElement(oe.a,null,n.a.createElement(oe.a.Header,null,n.a.createElement(x.a,{icon:O.w})," ",n.a.createElement(x.a,{icon:O.f})," Labels"),r,n.a.createElement(oe.a.Footer,{className:"text-muted"},n.a.createElement(Xe,{color:ze(),label:"",description:"",labelId:null,show:this.state.isLabelmodalShown,onLabelSaved:this.onLabelSaved,openBtn:n.a.createElement(C.a,{variant:"outline-secondary",block:!0},n.a.createElement(x.a,{icon:O.v})," Create New Label")})))):"")}}]),t}(a.Component),$e=function(e,t){var r;return function(){var a=arguments;clearTimeout(r),r=setTimeout(function(){e.apply(null,a)},t)}};var Qe=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end)};var r=window.getSelection().anchorNode.parentElement;return"words"===r.className&&{start:parseFloat(r.dataset.start),end:parseFloat(r.dataset.end)}}return!1};function Ze(e){var t=[],r=new Map,a=!0,n=!1,s=void 0;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var i=o.value;r.has(i.speaker)||(r.set(i.speaker,!0),t.push({value:i.speaker,label:i.speaker}))}}catch(l){n=!0,s=l}finally{try{a||null==c.return||c.return()}finally{if(n)throw s}}return t}var et=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=function(){r.context.getAllAnnotations(r.props.projectId,r.props.transcriptId).then(function(e){r.setState({annotations:e.annotations})})},r.onLabelCreate=function(e){r.context.createLabel(r.props.projectId,e).then(function(e){r.setState({labelsOptions:e.labels})})},r.onLabelUpdate=function(e){var t=r.context;console.log("updatedLabel",e),t.updateLabel(r.props.projectId,e.id,e).then(function(e){r.setState({labelsOptions:e.labels})})},r.onLabelDelete=function(e){r.context.deleteLabel(r.props.projectId,e).then(function(e){r.setState({labelsOptions:e.labels})})},r.handleTimecodeClick=function(e){if(e.target.classList.contains("timecode")){var t=e.target;r.videoRef.current.currentTime=t.dataset.start,r.videoRef.current.play()}},r.handleWordClick=function(e){if("words"===e.target.className){var t=e.target;r.videoRef.current.currentTime=t.dataset.start,r.videoRef.current.play()}},r.handleShowParagraphsMatchingSearch=function(){r.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}})},r.handleLabelsSearchChange=function(e){r.setState({selectedOptionLabelSearch:e})},r.handleSpeakersSearchChange=function(e){r.setState({selectedOptionSpeakerSearch:e})},r.handleSearch=function(e,t){if(""!==e.target.value){var a=e.target.value;r.setState({searchString:a.toLowerCase()}),$e(r.highlightWords(a),500)}else""===e.target.value&&r.setState({sentenceToSearchCSS:"",searchString:""})},r.highlightWords=function(e){var t=e.toLowerCase().trim().split(" "),a='.paragraph[data-paragraph-text*="'.concat(t.join(" "),'"]'),n=t.map(function(e,r){var n="".concat(a,' > div > span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return r<t.length-1&&(n+=", "),n}),s=t.map(function(e,r){var n="".concat(a,' > div  > span >span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return r<t.length-1&&(n+=", "),n});r.setState({sentenceToSearchCSS:n.join(" "),sentenceToSearchCSSInHighlights:s.join(" ")})},r.handleCreateAnnotation=function(e){var t=r.context,a=e.target,n=Qe();if(n){var s=r.state.annotations;n.labelId=a.dataset.labelId,n.note="";var o=n;console.log("newAnnotation",o),t.createAnnotation(r.props.projectId,r.props.transcriptId,o).then(function(e){var t=e.annotation;console.log("newAnnotationFromServer",t);var a=JSON.parse(JSON.stringify(s));a.push(t),r.setState({annotations:a})})}else alert("Select some text in the transcript to highlight ")},r.handleDeleteAnnotation=function(e){var t=r.context,a=r.state.annotations.filter(function(t){return t.id!==e}),n=JSON.parse(JSON.stringify(a));t.deleteAnnotation(r.props.projectId,r.props.transcriptId,e).then(function(e){r.setState({annotations:n})})},r.handleEditAnnotation=function(e){var t=r.context,a=r.state.annotations,n=a.find(function(t){return t.id===e}),s=prompt("Edit the text note of the annotation",n.note);s?(n.note=s,t.updateAnnotation(r.state.projectId,r.props.transcriptId,e,n).then(function(t){var n=t.annotation,s=a.filter(function(t){return t.id!==e});s.push(n),r.setState({annotations:s})})):alert("all good nothing changed")},r.showLabelsReference=function(){},r.getCurrentWordTime=function(){var e=r.props.transcript.words,t=r.state.currentTime,a=e.find(function(e){if(t>=e.start&&t<=e.end)return e.start});return void 0!==a?a[0]:0},r.videoRef=n.a.createRef(),r.state={searchString:"",showParagraphsMatchingSearch:!1,selectedOptionLabelSearch:!1,selectedOptionSpeakerSearch:[],sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",annotations:[],isLabelsListOpen:!0,labelsOptions:r.props.labelsOptions,currentTime:0},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e,t=this,r=this.state.currentTime,a=Math.round(4*r)/4,s=n.a.createElement("style",{scoped:!0},'span.words[data-prev-times~="'.concat(Math.floor(a),'"][data-transcript-id="').concat(this.props.transcriptId,'"] { color: ').concat("grey"," }")),o="audio"===this.props.mediaType?"100vh":"60vh";return e="audio"===this.props.mediaType?n.a.createElement(oe.a.Header,null,n.a.createElement("audio",{src:this.props.url,ref:this.videoRef,onTimeUpdate:function(e){t.setState({currentTime:e.target.currentTime})},style:{width:"100%",backgroundColor:"black"},controls:!0})):n.a.createElement(oe.a.Header,null,n.a.createElement("video",{src:this.props.url,ref:this.videoRef,onTimeUpdate:function(e){t.setState({currentTime:e.target.currentTime})},style:{width:"100%",backgroundColor:"black"},controls:!0})),n.a.createElement(n.a.Fragment,null,n.a.createElement("style",{scoped:!0},"".concat(this.state.sentenceToSearchCSS," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }"),"".concat(this.state.sentenceToSearchCSSInHighlights," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }")),n.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Transcript Title: ".concat(this.props.title)},this.props.title),n.a.createElement(oe.a,null,e,n.a.createElement(oe.a.Header,null,n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:12},n.a.createElement(ne.a,{style:{width:"100%"}},n.a.createElement(ce.a,{as:ne.a,style:{width:"100%"}},n.a.createElement(C.a,{variant:"outline-secondary","data-label-id":"default",onClick:this.handleCreateAnnotation},n.a.createElement(x.a,{icon:O.k,flip:"horizontal"})," Highlight"),n.a.createElement(ce.a.Toggle,{split:!0,variant:"outline-secondary","data-lable-id":0}),n.a.createElement(ce.a.Menu,{onClick:this.handleCreateAnnotation},this.state.labelsOptions&&this.state.labelsOptions.map(function(e){return n.a.createElement(ce.a.Item,{key:"label_id_".concat(e.id),"data-label-id":e.id},n.a.createElement(E.a,{"data-label-id":e.id},n.a.createElement(y.a,{xs:1,style:{backgroundColor:e.color},"data-label-id":e.id}),n.a.createElement(y.a,{xs:1,"data-label-id":e.id},e.label)))}))),n.a.createElement(ie.a,{drop:"right",as:ne.a,title:n.a.createElement(x.a,{icon:O.f}),id:"bg-nested-dropdown",variant:"outline-secondary"},n.a.createElement(Ye,{isLabelsListOpen:this.state.isLabelsListOpen,labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,onLabelUpdate:this.onLabelUpdate,onLabelCreate:this.onLabelCreate,onLabelDelete:this.onLabelDelete})))))),n.a.createElement(we,{labelsOptions:this.state.labelsOptions,speakersOptions:this.props.transcript?Ze(this.props.transcript.paragraphs):null,handleSearch:this.handleSearch,handleLabelsSearchChange:this.handleLabelsSearchChange,handleSpeakersSearchChange:this.handleSpeakersSearchChange,handleShowParagraphsMatchingSearch:this.handleShowParagraphsMatchingSearch}),n.a.createElement(oe.a.Body,{onDoubleClick:this.handleWordClick,onClick:this.handleTimecodeClick,style:{height:o,overflow:"scroll"}},s,this.props.transcript&&n.a.createElement(Ue,{labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,annotations:this.state.annotations?this.state.annotations:[],transcriptJson:this.props.transcript,searchString:this.state.searchString?this.state.searchString:"",showParagraphsMatchingSearch:this.state.showParagraphsMatchingSearch,selectedOptionLabelSearch:this.state.selectedOptionLabelSearch?this.state.selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:this.state.selectedOptionSpeakerSearch?this.state.selectedOptionSpeakerSearch:[],transcriptId:this.props.transcriptId,handleTimecodeClick:this.handleTimecodeClick,handleWordClick:this.handleWordClick,handleDeleteAnnotation:this.handleDeleteAnnotation,handleEditAnnotation:this.handleEditAnnotation}))))}}]),t}(a.Component);et.contextType=c;var tt=et,rt=r(65),at=r.n(rt),nt=function(e){function t(){return Object(d.a)(this,t),Object(h.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){var e=this,t=this.props.transcripts.map(function(e,t){return n.a.createElement(se.a.Item,{key:at()()},n.a.createElement(se.a.Link,{disabled:"done"!==e.status,eventKey:e.id},"in-progress"===e.status?n.a.createElement(x.a,{icon:O.e}):"","error"===e.status?n.a.createElement(x.a,{icon:O.g}):"","  ".concat(e.transcriptTitle)))}),r=this.props.transcripts.map(function(t,r){return n.a.createElement(G.a.Pane,{key:at()(),eventKey:t.id},n.a.createElement(tt,{projectId:e.props.projectId,transcriptId:t.id,labelsOptions:e.props.labelsOptions,title:t.transcriptTitle,transcript:t.transcript,mediaType:t.mediaType,url:t.url}))});return n.a.createElement(n.a.Fragment,null,n.a.createElement(G.a.Container,{defaultActiveKey:this.props.transcripts[0]?this.props.transcripts[0].id:"first"},n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:3},n.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Transcripts"},"Transcripts"),n.a.createElement("hr",null),n.a.createElement(se.a,{variant:"pills",className:"flex-column"},t)),n.a.createElement(y.a,{sm:9},n.a.createElement(G.a.Content,null,r)))))}}]),t}(a.Component),st=r(225),ot=r.n(st),ct=r(226),it=r.n(ct),lt=r(227),ut=r.n(lt),pt=r(228),dt=r.n(pt),ht=r(75),mt=r.n(ht),ft=r(111),bt=r.n(ft),gt=r(229),vt=r.n(gt);function wt(e){return{start:e.dataset.start,end:e.dataset.end,text:e.innerText,speaker:e.dataset.speaker,transcriptId:e.dataset.transcriptId}}var Et=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end),transcriptId:t[0].dataset.transcriptId,speaker:t[0].dataset.speaker,words:Array.from(t).map(function(e){return wt(e)})};var r=window.getSelection().anchorNode.parentElement;return"words"===r.className&&{start:parseFloat(r.dataset.start),end:parseFloat(r.dataset.end),transcriptId:r.dataset.transcriptId,speaker:r.dataset.speaker,words:[wt(r)]}}return!1},yt=function(e){var t=e[0];return 0===e.filter(function(e){return e.speaker!==t.speaker}).length},jt=function(e){if(yt(e))return e;var t=e[0].speaker,r=[],a=[];return e.forEach(function(n,s){n.speaker===t?r.push(n):(a.push(r),(r=[]).push(n),t=n.speaker),s===e.length-1&&a.push(r)}),a};function St(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}var kt="NA",xt=25,Ot="00:00:00:00",Pt="16000",Tt=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).updateVideoContextWidth=function(){r.setState({width:r.card.offsetWidth-10})},r.componentDidMount=function(){r.context.getPaperEdit(r.props.projectId,r.props.papereditId).then(function(e){var t=e.programmeScript;t.elements.push({type:"insert",text:"Insert Point to add selection"}),r.setState({programmeScript:t})}),r.updateVideoContextWidth(),window.addEventListener("resize",r.updateVideoContextWidth)},r.handleReorder=function(e){r.setState(function(t){var r=t.programmeScript;return r.elements=e,{programmeScript:r}})},r.handleDelete=function(e){r.setState(function(t){var r=t.programmeScript,a=e,n=r.elements;return n.splice(a,1),r.elements=n,{programmeScript:r}})},r.handleEdit=function(e){var t=r.state.programmeScript,a=t.elements,n=a[e],s=prompt("Edit",n.text);s&&(n.text=s,a[e]=n,t.elements=a,r.setState({programmeScript:t}))},r.handleAddTranscriptElementToProgrammeScript=function(e){var t=r.state.programmeScript,a=r.state.programmeScript.elements;if("title"===e||"note"===e||"voice-over"===e){var n=prompt("Add some text for a section title","Some place holder text");console.log(n);var s=r.getIndexPositionOfInsertPoint(),o={id:at()(),index:a.length,type:e,text:n};a.splice(s,0,o),t.elements=a,r.setState({programmeScript:t})}},r.getIndexPositionOfInsertPoint=function(){var e=r.state.programmeScript.elements,t=e.find(function(e){return"insert"===e.type});return e.indexOf(t)},r.handleAddTranscriptSelectionToProgrammeScript=function(){var e=Et();if(console.log("getDataFromUserWordsSelection::",e),e){console.log(JSON.stringify(e,null,2));var t=r.state.programmeScript,a=t.elements,n=r.getIndexPositionOfInsertPoint();if(yt(e.words)){var s={id:at()(),index:a.length,type:"paper-cut",start:e.start,end:e.end,speaker:e.speaker,words:e.words,transcriptId:e.transcriptId,labelId:[]};a.splice(n,0,s),t.elements=a}else{jt(e.words).reverse().forEach(function(e){var r={id:at()(),index:a.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};a.splice(n,0,r),t.elements=a})}r.setState({programmeScript:t})}else alert("Select some text in the transcript to add to the programme script"),console.log("nothing selected")},r.getSequenceJsonEDL=function(){var e,t={title:r.state.programmeScript.title,events:[]},a=r.state.programmeScript.elements.map(function(e){if("paper-cut"===e.type){var t=r.props.transcripts.find(function(t){return t.id===e.transcriptId});return{startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:kt,clipName:"".concat(t.clipName),fps:t.metadata?t.metadata.fps:xt,offset:t.metadata?t.metadata.timecode:Ot,sampleRate:t.metadata?t.metadata.sampleRate:Pt}}return null}).filter(function(e){return null!==e}).map(function(e,t){return e.id=t+1,e});return(e=t.events).push.apply(e,Object(B.a)(a)),t},r.handleExportEDL=function(){var e=r.getSequenceJsonEDL(),t=new it.a(e);console.log(t.compose()),mt()(t.compose(),"".concat(r.state.programmeScript.title,".edl"),"text/plain")},r.handleExportADL=function(){var e=r.getSequenceJsonEDL(),t=e.events[0],a=ut()({projectOriginator:"Digital Paper Edit",edits:e.events.map(function(e){return{start:e.startTime,end:e.endTime,clipName:e.clipName,label:""}}),sampleRate:t.sampleRate,frameRate:t.fps,projectName:e.title});mt()(a,"".concat(r.state.programmeScript.title,".adl"),"text/plain")},r.handleExportFCPX=function(){var e=r.getSequenceJsonEDL();console.log(e);var t=dt()(e);mt()(t,"".concat(r.state.programmeScript.title,".fcpxml"),"text/plain")},r.getProgrammeScriptJson=function(){var e,t={title:r.state.programmeScript.title,events:[]},a=r.state.programmeScript.elements.map(function(e){if("paper-cut"===e.type){console.log("paper-cut::",e);var t=r.props.transcripts.find(function(t){return t.id===e.transcriptId});return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?St(r,!0).forEach(function(t){Object(T.a)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):St(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e,{startTime:e.start,endTime:e.end,reelName:t.metadata?t.metadata.reelName:kt,clipName:"".concat(t.clipName),fps:t.metadata?t.metadata.fps:xt,sampleRate:t.metadata?t.metadata.sampleRate:Pt,offset:t.metadata?t.metadata.timecode:Ot})}return e}).filter(function(e){return null!==e}).map(function(e,t){return e.id=t+1,e});return(e=t.events).push.apply(e,Object(B.a)(a)),console.log(t),t},r.programmeScriptJsonToText=function(e){var t="# ".concat(e.title,"\n\n"),r=e.events.map(function(e){return"title"===e.type?"## ".concat(e.text):"voice-over"===e.type?"_".concat(e.text,"_"):"note"===e.type?"[ ".concat(e.text,"]"):"paper-cut"===e.type?"".concat(bt.a.fromSeconds(e.startTime),"\t").concat(bt.a.fromSeconds(e.endTime),"\t").concat(e.speaker,"\t-\t").concat(e.clipName,"     \n").concat(e.words.map(function(e){return e.text}).join(" ")):null});return"".concat(t).concat(r.join("\n\n"))},r.handleExportJson=function(){var e=r.getProgrammeScriptJson(),t=JSON.stringify(e,null,2);mt()(t,"".concat(r.state.programmeScript.title,".json"),"text/plain")},r.handleExportTxt=function(){var e=r.getProgrammeScriptJson(),t=r.programmeScriptJsonToText(e);mt()(t,"".concat(r.state.programmeScript.title,".txt"),"text/plain")},r.getTranscript=function(e){return r.props.transcripts.find(function(t){return t.id===e})},r.getPlayList=function(){var e=0;return r.state.programmeScript.elements.filter(function(e){return"paper-cut"===e.type}).map(function(t){r.getTranscript(t.transcriptId);var a={type:"video",start:e,sourceStart:t.start,duration:t.end-t.start,src:r.getTranscript(t.transcriptId).url};return e+=a.duration,a})},r.handleUpdatePreview=function(){var e=r.getPlayList();r.setState({resetPreview:!0},function(){console.log("handleUpdatePreview",e),r.setState({resetPreview:!1,playlist:e})}),console.log("handleUpdatePreview",e),r.setState({playlist:e})},r.handleDoubleClickOnProgrammeScript=function(e){if("words"===e.target.className){var t=e.target.dataset.start;console.log("wordCurrentTime::",t)}},r.handleSaveProgrammeScript=function(){var e=r.context,t=r.state.programmeScript;if(t){var a=t.elements,n=a.find(function(e){return"insert"===e.type});if(n){var s=a.indexOf(n);a.splice(s,1)}t.elements=a,e.updatePaperEdit(r.props.projectId,r.props.papereditId,t).then(function(e){"ok"===e.status&&alert("saved programme script")})}},r.state={programmeScript:null,resetPreview:!1,width:150,playlist:[]},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateVideoContextWidth)}},{key:"render",value:function(){var e=this;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Programme Script Title: ".concat(this.state.programmeScript?this.state.programmeScript.title:"")},this.state.programmeScript?this.state.programmeScript.title:""),n.a.createElement(oe.a,null,n.a.createElement(oe.a.Header,{ref:function(t){return e.card=t}},n.a.createElement("div",null,n.a.createElement("span",null,this.state.resetPreview?null:n.a.createElement(ot.a,{width:this.state.width,playlist:this.state.playlist})))),n.a.createElement(oe.a.Header,null,n.a.createElement(E.a,{noGutters:!0},n.a.createElement(y.a,{sm:12,md:3},n.a.createElement(C.a,{variant:"outline-secondary",onClick:this.handleAddTranscriptSelectionToProgrammeScript,title:"Add a text selection, select text in the transcript, then click this button to add it to the programme script"},n.a.createElement(x.a,{icon:O.o})," Selection")),n.a.createElement(y.a,{sm:12,md:2,ld:2,xl:2},n.a.createElement(ce.a,null,n.a.createElement(ce.a.Toggle,{variant:"outline-secondary"},n.a.createElement(x.a,{icon:O.o})),n.a.createElement(ce.a.Menu,null,n.a.createElement(ce.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("title")},title:"Add a title header element to the programme script"},n.a.createElement(x.a,{icon:O.j})," Heading"),n.a.createElement(ce.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("voice-over")},title:"Add a title voice over element to the programme script"},n.a.createElement(x.a,{icon:O.m})," Voice Over"),n.a.createElement(ce.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("note")},title:"Add a note element to the programme script"},n.a.createElement(x.a,{icon:O.s})," Note")))),n.a.createElement(y.a,{sm:12,md:3},n.a.createElement(C.a,{variant:"outline-secondary",onClick:this.handleUpdatePreview,title:"update preview"},n.a.createElement(x.a,{icon:O.t})," Preview")),n.a.createElement(y.a,{sm:12,md:3},n.a.createElement(ce.a,null,n.a.createElement(ce.a.Toggle,{variant:"outline-secondary"},n.a.createElement(x.a,{icon:O.r})," Export"),n.a.createElement(ce.a.Menu,null,n.a.createElement(ce.a.Item,{onClick:this.handleExportEDL,title:"export EDL, edit decision list, to import the programme script as a sequence in video editing software - Avid, Premiere, Davinci Resolve, for FCPX choose FCPX XML"},"EDL - Video ",n.a.createElement(x.a,{icon:O.l})),n.a.createElement(ce.a.Item,{onClick:this.handleExportADL,title:"export ADL, audio decision list, to import the programme script as a sequence in audio editing software such as SADiE"},"ADL - Audio  ",n.a.createElement(x.a,{icon:O.l})),n.a.createElement(ce.a.Item,{onClick:this.handleExportFCPX,title:"export FCPX XML, to import the programme script as a sequence in Final Cut Pro X, video editing software"},"FCPX ",n.a.createElement(x.a,{icon:O.l})),n.a.createElement(ce.a.Divider,null),n.a.createElement(ce.a.Item,{onClick:this.handleExportTxt,title:"export Text, export the programme script as a text version"},"Text File ",n.a.createElement(x.a,{icon:O.l})),n.a.createElement(ce.a.Item,{onClick:function(){alert("export word doc not implemented yet")},title:"export docx, export the programme script as a word document"},"Word Document ",n.a.createElement(x.a,{icon:O.l})),n.a.createElement(ce.a.Divider,null),n.a.createElement(ce.a.Item,{onClick:this.handleExportJson,title:"export Json, export the programme script as a json file"},"Json ",n.a.createElement(x.a,{icon:O.l}))))),n.a.createElement(y.a,{sm:12,md:1},n.a.createElement(C.a,{variant:"outline-secondary",onClick:this.handleSaveProgrammeScript,title:"save programme script",block:!0},n.a.createElement(x.a,{icon:O.p}))))),n.a.createElement(oe.a.Body,null,n.a.createElement("article",{style:{height:"60vh",overflow:"scroll"},onDoubleClick:this.handleDoubleClickOnProgrammeScript},this.state.programmeScript?n.a.createElement(vt.a,{items:this.state.programmeScript.elements,handleReorder:this.handleReorder,handleDelete:this.handleDelete,handleEdit:this.handleEdit}):null))))}}]),t}(a.Component);Tt.contextType=c;var Ct=Tt,It=function(e){function t(e){var r;return Object(d.a)(this,t),(r=Object(h.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=Object(v.a)(g.a.mark(function e(){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.context.getProgrammeScriptAndTranscripts(r.state.projectId,r.state.papereditId).then(function(e){r.setState({programmeTitle:e.programmeScript.title,projectTitle:e.project.title,transcripts:e.transcripts,labelsOptions:e.labels})});case 2:case"end":return e.stop()}},e)})),r.toggleTranscripts=function(){r.state.isProgramScriptShown&&r.setState(function(e){return{isTranscriptsShown:!e.isTranscriptsShown}})},r.toggleProgramScript=function(){r.state.isTranscriptsShown&&r.setState(function(e){return{isProgramScriptShown:!e.isProgramScriptShown}})},r.state={projectId:r.props.match.params.projectId,papereditId:r.props.match.params.papereditId,projectTitle:"",programmeTitle:"",transcripts:[],labelsOptions:[],isTranscriptsShown:!0,isProgramScriptShown:!0,videoHeight:"10em"},r}return Object(f.a)(t,e),Object(Z.a)(t,[{key:"render",value:function(){return n.a.createElement(u.a,{style:{marginBottom:"5em"},fluid:!0},n.a.createElement("br",null),n.a.createElement(E.a,null,n.a.createElement(y.a,{sm:12},n.a.createElement(S.a,{items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"PaperEdits"},{name:"".concat(this.state.programmeTitle)}]}))),n.a.createElement(u.a,{fluid:!0},n.a.createElement("div",{className:"d-flex flex-column"},n.a.createElement(ne.a,{size:"sm",className:"mt-12"},n.a.createElement(C.a,{onClick:this.toggleTranscripts,variant:this.state.isTranscriptsShown?"secondary":"outline-secondary"},"Transcripts ",n.a.createElement(x.a,{icon:this.state.isTranscriptsShown?O.b:O.c})," ",this.state.isTranscriptsShown?"hide":"show"),n.a.createElement(C.a,{onClick:this.toggleProgramScript,variant:this.state.isProgramScriptShown?"secondary":"outline-secondary"},"Program Script  ",n.a.createElement(x.a,{icon:this.state.isProgramScriptShown?O.b:O.c}),"  ",this.state.isProgramScriptShown?"hide":"show"))),n.a.createElement(E.a,null,n.a.createElement(y.a,{xs:{span:12,offset:0},sm:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},md:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},lg:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},xl:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},style:{display:this.state.isTranscriptsShown?"block":"none"}},this.state.transcripts.length?n.a.createElement(nt,{projectId:this.state.projectId,transcripts:this.state.transcripts,labelsOptions:this.state.labelsOptions}):n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("i",null,"No Transcripts, create a transcript to get started"))),n.a.createElement(y.a,{xs:{span:12,offset:0},sm:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},md:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},lg:{span:this.state.isTranscriptsShown?5:10,offset:this.state.isTranscriptsShown?0:1},xl:{span:this.state.isTranscriptsShown?5:8,offset:this.state.isTranscriptsShown?0:2},style:{display:this.state.isProgramScriptShown?"block":"none"}},n.a.createElement(Ct,{projectId:this.state.projectId,papereditId:this.state.papereditId,transcripts:this.state.transcripts,videoHeight:this.props.videoHeight})))))}}]),t}(a.Component);It.contextType=c;var Lt=It,At=function(e){function t(e){var r;return Object(d.a)(this,t),r=Object(h.a)(this,Object(m.a)(t).call(this,e)),console.log("initial history is: ",JSON.stringify(r.history,null,2)),r.history.listen(function(e,t){console.log("The current URL is ".concat(e.pathname).concat(e.search).concat(e.hash)),console.log("The last navigation action was ".concat(t),JSON.stringify(r.history,null,2))}),r}return Object(f.a)(t,e),t}(r(80).BrowserRouter),Dt=function(){return n.a.createElement("h1",null,"There was an error loading the page you requested")},Nt=function(){return n.a.createElement(At,null,n.a.createElement(te.g,null,n.a.createElement(te.c,{from:"/",to:"/projects"}),n.a.createElement(te.d,{path:"/projects",component:V}),n.a.createElement(te.d,{path:"/projects/:projectId",component:Q}),n.a.createElement(te.d,{exact:!0,path:"/projects/:projectId/transcripts/:transcriptId/correct",component:ae}),n.a.createElement(te.d,{exact:!0,path:"/projects/:projectId/paperedits/:papereditId",component:Lt}),n.a.createElement(te.d,{component:Dt})))},Ut=r(230),Ft=r.n(Ut),Mt=["GET","POST","PUT","DELETE"],Rt=function(e){if(!Mt.includes(e))throw new Error("Wrong method passed ".concat(e," - should be one of ").concat(Mt))},Jt=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;return"PUT"===e?t={method:e,mode:"cors",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}:"POST"===e?(t={method:e},"json"===a?(t.headers={"Content-Type":"application/json"},t.body=JSON.stringify(r)):t.body=r):t={method:e,mode:"cors"},t};function Wt(){return(Wt=Object(v.a)(g.a.mark(function e(t){var r,a,n,s,o=arguments;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:"GET",a=o.length>2&&void 0!==o[2]?o[2]:{},n=o.length>3?o[3]:void 0,Rt(r),s=Jt(r,a,n),e.next=7,fetch(t,s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var _t=function(e){return Wt.apply(this,arguments)},Bt=function(){function e(){var t=this;Object(d.a)(this,e),this.projectsIdUrl=function(e){return"".concat(t.projectsUrl,"/").concat(e)},this.transcriptsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/transcripts")},this.transcriptsIdUrl=function(e,r,a){var n=a?"?".concat(Ft.a.stringify(a)):"";return"".concat(t.transcriptsUrl(e),"/").concat(r).concat(n).trim()},this.paperEditsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/paperedits")},this.paperEditsIdUrl=function(e,r){return"".concat(t.projectsIdUrl(e),"/paperedits/").concat(r)},this.annotationsUrl=function(e,r){return"".concat(t.transcriptsIdUrl(e,r),"/annotations")},this.annotationsIdUrl=function(e,r,a){return"".concat(t.transcriptsIdUrl(e,r),"/annotations/").concat(a)},this.labelsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/labels")},this.labelsIdUrl=function(e,r){return"".concat(t.projectsIdUrl(e),"/labels/").concat(r)},this.baseUrl=window.env.API_URL,window.env.API_URL=null,this.projectsUrl="".concat(this.baseUrl,"/api/projects")}return Object(Z.a)(e,[{key:"getAllProjects",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.projectsUrl);case 2:return t=e.sent,e.next=5,t.json();case 5:return r=e.sent,e.abrupt("return",r.projects);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.projectsIdUrl(t));case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.projectsUrl,"POST",t,"json");case 2:return r=e.sent,e.next=5,r.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.projectsIdUrl(t),"PUT",r);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.projectsIdUrl(t),"DELETE");case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTranscripts",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.transcriptsUrl(t));case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.transcriptsUrl(t),"POST",r);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.transcriptsIdUrl(t,r,a));case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,e.next=8,this.getProject(t);case 8:return o=e.sent,s.projectTitle=o.project.title,s.transcriptTitle=s.title,delete s.title,e.abrupt("return",s);case 13:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"updateTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a,n){var s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.transcriptsIdUrl(t,r,a),"PUT",n);case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}},e,this)}));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"deleteTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.transcriptsIdUrl(t,r),"DELETE");case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAllAnnotations",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.annotationsUrl(t,r));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.annotationsIdUrl(t,r,a));case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"createAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.annotationsUrl(t,r),"POST",a,"json");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"updateAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a,n){var s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.annotationsIdUrl(t,r,a),"PUT",n);case 2:return s=e.sent,e.next=5,s.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"deleteAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.annotationsIdUrl(t,r,a),"DELETE");case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"getAllLabels",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.labelsUrl(t));case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.labelsIdUrl(t,r));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"createLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.labelsUrl(t),"POST",r,"json");case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.labelsIdUrl(t,r),"PUT",a);case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"deleteLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.labelsIdUrl(t,r),"DELETE");case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAllPaperEdits",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.paperEditsUrl(t));case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,e.abrupt("return",a.paperedits);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.paperEditsIdUrl(t,r));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"createPaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.paperEditsUrl(t),"POST",r,"json");case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"updatePaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.paperEditsIdUrl(t,r),"PUT",a);case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"deletePaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_t(this.paperEditsIdUrl(t,r),"DELETE");case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTranscriptLabelsAnnotations",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscript(t,r);case 2:return a=e.sent,e.next=5,this.getAllLabels(t,r);case 5:return n=e.sent,e.next=8,this.getAllAnnotations(t,r);case 8:return s=e.sent,o={transcriptId:r,projectId:t,projectTitle:a.projectTitle,transcriptTitle:a.transcriptTitle,url:a.url,labels:n.labels,transcript:a.transcript,annotations:s.annotations},e.abrupt("return",o);case 11:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getProgrammeScriptAndTranscripts",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s,o,c,i,l,u=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscripts(t);case 2:return a=e.sent,e.next=5,Promise.all(a.transcripts.map(function(e){return u.getTranscript(t,e.id)}));case 5:return n=e.sent,e.next=8,Promise.all(a.transcripts.map(function(e){return u.getAllAnnotations(t,e.id)}));case 8:return s=e.sent,n.forEach(function(e){var t=s.find(function(t){return t.transcriptId===e.id});e.annotations=t?t.annotations:[]}),e.next=12,this.getPaperEdit(t,r);case 12:return o=e.sent,e.next=15,this.getProject(t);case 15:return c=e.sent,e.next=18,this.getAllLabels(t);case 18:return i=e.sent,l={programmeScript:o.programmeScript,project:c.project,transcripts:n,labels:i.labels},e.abrupt("return",l);case 21:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),qt=function(){function e(){Object(d.a)(this,e),this.url="http://localhost:3000/db/",this.projects=this.url+"projects.json",this.paperEdits=this.url+"paperedits.json",this.transcripts=this.url+"transcripts.json",this.labels=this.url+"labels.json",this.annotations=this.url+"annotations.json"}return Object(Z.a)(e,[{key:"getAllProjects",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,r,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.projects);case 2:return t=e.sent,e.next=5,t.json();case 5:if(r=e.sent,0,0===r.length){e.next=10;break}return a=r.map(function(e){return e.id=e._id,e}),e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.projects);case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,n=a.find(function(e){return e._id===t}),e.abrupt("return",{status:"ok",project:n});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t),e.abrupt("return",{status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"deleteProject",value:function(){var e=Object(v.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t),e.abrupt("return",{ok:!1,status:"false",project:{}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTranscripts",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.transcripts);case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,n=a.filter(function(e){return e.projectId===t}).map(function(e){return e.id=e._id,e}),e.abrupt("return",{transcripts:n});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a),e.abrupt("return",{status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"getTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s,o,c;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.transcripts);case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,(o=s.find(function(e){return e._id===r})).id=o._id,e.next=10,this.getProject(t);case 10:return c=e.sent,o.projectTitle=c.project.title,o.transcriptTitle=o.title,e.abrupt("return",o);case 14:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"updateTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a,n){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a,n),e.abrupt("return",{ok:!1});case 3:case"end":return e.stop()}},e)}));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"deleteTranscript",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAllAnnotations",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.annotations);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=(n=(n=e.sent).filter(function(e){return e.transcriptId===r}))?n.map(function(e){return e.id=e._id,e}):[],e.abrupt("return",{annotations:n});case 9:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){var n,s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.annotations);case 2:return n=e.sent,e.next=5,n.json();case 5:return s=e.sent,o=s[0],e.abrupt("return",{annotation:o});case 8:case"end":return e.stop()}},e,this)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"createAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a),e.abrupt("return",{ok:!1,status:"false",annotation:[]});case 3:case"end":return e.stop()}},e)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"deleteAnnotation",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"getAllLabels",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.labels);case 2:return r=e.sent,e.next=5,r.json();case 5:return a=e.sent,n=a[0],(a=a.filter(function(e){return e.projectId===t})).unshift(n),a||(a=[]),e.abrupt("return",{ok:!0,status:"ok",labels:a});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.labels);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,s=n[0],e.abrupt("return",{ok:!0,status:"ok",label:s});case 8:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"createLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"deleteLabel",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAllPaperEdits",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var r,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.paperEdits);case 2:return r=e.sent,e.next=5,r.json();case 5:return a=(a=e.sent).filter(function(e){return e.projectId===t}),(n={}).paperedits=[],n.paperedits=a,n.paperedits&&(n.paperedits=n.paperedits.map(function(e){return e.id=e._id,e})),e.abrupt("return",n.paperedits);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r,e.next=3,fetch(this.paperEdits);case 3:return n=e.sent,e.next=6,n.json();case 6:return s=e.sent,(o=s.find(function(e){return e.id===a}))||(new Error("No paper edit found").statusCode=404),e.abrupt("return",{ok:!0,status:"ok",programmeScript:o});case 10:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"createPaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"updatePaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r,a){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r,a),e.abrupt("return",{ok:!0,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"deletePaperEdit",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return alert("Not implemented in demo mode"),console.log(t,r),e.abrupt("return",{ok:!1,status:"false"});case 3:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTranscriptLabelsAnnotations",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s,o;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscript(t,r);case 2:return a=e.sent,e.next=5,this.getAllLabels(t,r);case 5:return n=e.sent,e.next=8,this.getAllAnnotations(t,r);case 8:return s=e.sent,o={transcriptId:r,projectId:t,projectTitle:a.projectTitle,transcriptTitle:a.transcriptTitle,url:a.url,labels:n.labels,transcript:a.transcript,annotations:s.annotations},e.abrupt("return",o);case 11:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()},{key:"getProgrammeScriptAndTranscripts",value:function(){var e=Object(v.a)(g.a.mark(function e(t,r){var a,n,s,o,c,i,l,u=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscripts(t);case 2:return a=e.sent,e.next=5,Promise.all(a.transcripts.map(function(e){return u.getTranscript(t,e.id)}));case 5:return n=e.sent,e.next=8,Promise.all(a.transcripts.map(function(e){return u.getAllAnnotations(t,e.id)}));case 8:return s=e.sent,n.forEach(function(e){var t=s.find(function(t){return t.transcriptId===e.id});e.annotations=t?t.annotations:[]}),e.next=12,this.getPaperEdit(t,r);case 12:return o=e.sent,e.next=15,this.getProject(t);case 15:return c=e.sent,e.next=18,this.getAllLabels(t);case 18:return i=e.sent,l={programmeScript:o.programmeScript,project:c.project,transcripts:n,labels:i.labels},e.abrupt("return",l);case 21:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),Ht=r(231),zt=Object(Ht.a)(),Vt=function(){if("demo"===zt){console.log("API Wrapper demo time!");var e=new qt;return Object.freeze(e),e}if("browser"===zt){var t=new Bt;return Object.freeze(t),t}if("electron"===zt){var r=new(0,window.ElectronWrapper);return Object.freeze(r),r}}(),Kt=n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null," This is a demo version of the app ",n.a.createElement(p.a.Link,{href:"https://github.com/bbc/digital-paper-edit-client",target:"_blank",rel:"noopener noreferrer"},"see project Github repository for more info"),"."),n.a.createElement("p",null,"This is a read-only demo you can only play around with existing projects!")),Gt=function(){var e=null,t=null;return e=n.a.createElement(u.a,null,n.a.createElement(l.a,{variant:"warning",heading:"Demo mode",message:Kt})),navigator.onLine||(t=n.a.createElement(n.a.Fragment,null,n.a.createElement("br",null),n.a.createElement(u.a,null,n.a.createElement(l.a,{variant:"warning",heading:"Offline warning",message:"You don't seem to be connected to the internet "})))),n.a.createElement(n.a.Fragment,null,e,t,n.a.createElement(c.Provider,{value:Vt},n.a.createElement(Nt,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(Gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[238,1,2]]]);
//# sourceMappingURL=main.74dfdb88.chunk.js.map